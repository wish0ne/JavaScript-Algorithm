import fs from "fs";
let input = fs.readFileSync("../test.txt").toString().split("\n");
const n = parseInt(input[0]);

class Queue {
  constructor() {
    this._arr = [];
  }
  enqueue(item) {
    this._arr.push(item);
  }
  dequeue() {
    return this._arr.shift();
  }
  isEmpty() {
    return this._arr.length === 0;
  }
}

const indegree = new Array(n + 1).fill(0); //ì§„ìž…ì°¨ìˆ˜
const graph = []; //ê·¸ëž˜í”„
for (let i = 0; i < n + 1; i++) {
  graph.push([]);
}
const cost = new Array(n + 1).fill(0); //ì‹œê°„

for (let i = 1; i < n + 1; i++) {
  const arr = input[i].split(" ").map(Number);
  arr.pop(); // -1 ì œê±°
  cost[i] = arr.shift(); //ì²«ë²ˆì§¸ ì›ì†Œ ì œê±°(ì‹œê°„)
  //ê°„ì„  ì¶”ê°€ (jê°€ ië¥¼ ê°€ë¦¬í‚´)
  for (let j of arr) {
    graph[j].push(i);
  }
  indegree[i] += arr.length; //ì§„ìž…ì°¨ìˆ˜ ì¦ê°€(ì‹œê°„ê³¼ -1ì„ ì œê±°í•œ ë°°ì—´ì˜ ê°œìˆ˜ë§Œí¼ì´ ì§„ìž…ì°¨ìˆ˜ê°€ë¨)
}
const result = [...cost];
//javascriptì˜ shallow copy vs deep copy ì •ë¦¬
//https://myhappyman.tistory.com/221
//1) let obj2 = obj1ê³¼ ê°™ì€ ëŒ€ìž…ì—°ì‚°ìžë¥¼ í†µí•œ ë³µì‚¬ëŠ” ì–•ì€ ë³µì‚¬. ê°™ì€ ê°’ì´ë˜ë¯€ë¡œ í•˜ë‚˜ê°€ ë³€ê²½ë˜ë©´ ê°™ì´ ë³€ê²½ë¨
//2) let obj2 = {...obj1} ì „ê°œì—°ì‚°ìžë¥¼ ì´ìš©í•˜ì—¬ ë³µì‚¬í•˜ë©´ ê¹Šì€ ë³µì‚¬. ì´ë•Œ ë‹¨ìˆœë°°ì—´ ë˜ëŠ” ë‹¨ìˆœê°ì²´ì—¬ì•¼ë§Œ ê¹Šì€ë³µì‚¬ê°€ ì§„í–‰ë¨!!
//3) let obj1 = [{a:1, b:2}, {a:3, b:4}]ì™€ ê°™ì´ ë°°ì—´ì•ˆì— ê°ì²´ë“¤ì´ ì¡´ìž¬í•˜ëŠ” ê²½ìš°
//let obj2 = [...obj1]ì„ í•˜ê²Œë˜ë©´ obj1ê³¼ obj2ì˜ ë°°ì—´ë§Œ ë¹„êµí–ˆì„ë•ŒëŠ” ë‹¤ë¥¸ ì£¼ì†Œê°’ì„ ê°€ë¦¬í‚´.
//í•˜ì§€ë§Œ obj1[0].aì™€ obj2[0].aëŠ” ê°™ì€ê°’ì„ ê°€ë¦¬í‚´!! ê°ì²´ì£¼ì†Œê°’ì€ ê°™ì€ê³³ì„ ê°€ë¦¬í‚¤ê¸° ë•Œë¬¸. ê·¸ëž˜ì„œ ë‚´ë¶€ì˜ ê°ì²´ë‚˜ ë°°ì—´ì´ ì›ë³¸ì˜ ê°’ì„ ì°¸ì¡°í•˜ê³  ìžˆìœ¼ë¯€ë¡œ ì–•ì€ë³µì‚¬ê°€ ë¨. (ì¦‰ ì „ê°œì—°ì‚°ìžëŠ” ê°€ìž¥ ë°”ê¹¥ìª½ì˜ ê°’ë§Œ ë³µì‚¬í•´ì¤€ë‹¤ê³  ìƒê°í•˜ë©´ ë ë“¯)
//4) ë”°ë¼ì„œ ë‚´ë¶€ì˜ ê°ì²´ê¹Œì§€ ê¹Šì€ë³µì‚¬ë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” let obj2=[...obj1]ì´í›„
// obj2[0]={...obj2[0], a:5}ë¥¼ í•´ì¤˜ì•¼í•¨. ê·¸ëŸ¼ obj1[0]ê³¼ obj2[0]ë„ ë‹¤ë¥¸ ì£¼ì†Œê°’ì„ ê°€ë¦¬í‚¤ê²Œë¨.
// (ì´ë•Œ obj1[1]ê³¼ obj2[1]ëŠ” ì—¬ì „ížˆ ê°™ì€ ì£¼ì†Œê°’ì„ ê°€ë¦¬í‚¤ê³  ìžˆë‹¤ëŠ”ê²ƒë„ ì•Œìˆ˜ìžˆìŒ.)

function topology_sort() {
  const q = new Queue();

  //ì§„ìž…ì°¨ìˆ˜ê°€ 0ì¸ ë…¸ë“œë“¤ì„ íì— ì‚½ìž…
  for (let i = 1; i < n + 1; i++) {
    if (indegree[i] === 0) q.enqueue(i);
  }

  while (!q.isEmpty()) {
    const now = q.dequeue();

    //í˜„ìž¬ ì›ì†Œì™€ ì—°ê²°ëœ ë…¸ë“œë“¤ì˜ ì§„ìž…ì°¨ìˆ˜ 1ì”© ì œê±°
    for (let i of graph[now]) {
      indegree[i] -= 1;
      result[i] = Math.max(result[now] + cost[i], result[i]); //âŒâŒì‹œê°„ êµ¬í•˜ëŠ” ë¶€ë¶„ì—ì„œ ì‹¤ìˆ˜!!
      //ìƒˆë¡­ê²Œ ì§„ìž…ì°¨ìˆ˜ê°€ 0ì´ ë˜ëŠ” ë…¸ë“œë¥¼ íì— ì‚½ìž…
      if (indegree[i] === 0) {
        q.enqueue(i);
      }
    }
  }

  for (let i = 1; i < n + 1; i++) {
    console.log(result[i]);
  }
}

topology_sort();

//solveì¸ì¤„ ì•Œì•˜ìœ¼ë‚˜ ížˆë“  ì¼€ì´ìŠ¤ì—ì„œ í‹€ë¦° ì½”ë“œ ðŸ˜¥ðŸ˜«
//í•˜ë‚˜ì˜ ê³¼ëª©ì— ë™ì¼í•œ ê³„ì¸µì˜ ì„ ìˆ˜ê°•ì´ 2ê°œ ìžˆì„ë•Œ, ë” ê¸´ ì‹œê°„ìœ¼ë¡œ ê°±ì‹ í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì„ ë¹¼ë¨¹ìŒ!!
//í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ë§Œ ë§Œì¡±í•œë‹¤ê³  solveê°€ ì•„ë‹ˆë©°, ì˜ˆì™¸ê°€ ë°œìƒí•˜ëŠ” ížˆë“ ì¼€ì´ìŠ¤ë¥¼ ìŠ¤ìŠ¤ë¡œ ìƒê°í•´ë‚¼ ìˆ˜ ìžˆëŠ”ê²ƒë„ ì¤‘ìš”í•œ ëŠ¥ë ¥ì¸ ê²ƒ ê°™ë‹¤ ðŸ“
//ê¹Šì€ë³µì‚¬, ì–•ì€ ë³µì‚¬ë„ ê¸°ì–µí•´ë‘ìž

// 5
// 10 -1
// 10 1 -1
// 4 1 -1
// 4 3 1 -1
// 3 3 -1
